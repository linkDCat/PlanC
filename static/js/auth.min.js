function Auth(){this.maskwrapper=$(".mask-wrapper"),this.scrollWrapper=$(".scroll-wrapper")}Auth.prototype.run=function(){var t=this;t.listenshowEvent(),t.listenhideEvent(),t.listenSwitch(),t.listenSigninEvent(),t.listenAuthBoxHover(),t.listenimgCaptcha(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskwrapper.show()},Auth.prototype.hideEvent=function(){this.maskwrapper.hide()},Auth.prototype.listenshowEvent=function(){var t=this,n=$("#signin-btn"),e=$("#signup-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:"-400px"})})},Auth.prototype.listenhideEvent=function(){var t=this;$(".close-btn").click(function(){t.hideEvent()})},Auth.prototype.listenSwitch=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenimgCaptcha=function(){var t=$(".img-captcha-btn");t.click(function(){t.attr("src","/account/img_captcha/?random"+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptcha.addClass("disabled");var n=10;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),(n-=1)<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,t=$(".sms-captcha-btn"),e=$(".signup-group input[name='telephone']");t.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码！"),catajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.smsSuccessEvent()},fail:function(t){console.log(t)}})})},Auth.prototype.listenSignupEvent=function(){var m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),s=m.find("input[name='img_captcha']"),a=m.find("input[name='password1']"),i=m.find("input[name='password2']"),o=m.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),p=s.val(),u=a.val(),l=i.val(),h=o.val();catajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){window.location.reload()}})})},Auth.prototype.listenAuthBoxHover=function(){var t=$(".authwrapper"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),i=t.find("input[name='password']"),o=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=s.val(),n=i.val(),e=o.prop("checked");catajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){if(200==t.code)a.hideEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var s=n[e][0];window.messageBox.show(s)}}},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),s=((new Date).getTime()-e)/1e3;return s<60?"刚刚":60<=s&&s<3600?(minutes=parseInt(s/60),minutes+"分钟前"):3600<=s&&s<86400?(hours=parseInt(s/60/60),hours+"小时前"):86400<=s&&s<2592e3?(days=parseInt(s/60/60/24),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiQXV0aCIsInRoaXMiLCJtYXNrd3JhcHBlciIsIiQiLCJzY3JvbGxXcmFwcGVyIiwicHJvdG90eXBlIiwicnVuIiwic2VsZiIsImxpc3RlbnNob3dFdmVudCIsImxpc3RlbmhpZGVFdmVudCIsImxpc3RlblN3aXRjaCIsImxpc3RlblNpZ25pbkV2ZW50IiwibGlzdGVuQXV0aEJveEhvdmVyIiwibGlzdGVuaW1nQ2FwdGNoYSIsImxpc3RlblNtc0NhcHRjaGFFdmVudCIsImxpc3RlblNpZ251cEV2ZW50Iiwic2hvd0V2ZW50Iiwic2hvdyIsImhpZGVFdmVudCIsImhpZGUiLCJzaWduaW5CdG4iLCJzaWdlbnVwQnRuIiwiY2xpY2siLCJjc3MiLCJsZWZ0IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJpbWdDYXB0Y2hlIiwiYXR0ciIsIk1hdGgiLCJyYW5kb20iLCJzbXNTdWNjZXNzRXZlbnQiLCJtZXNzYWdlQm94Iiwic2hvd1N1Y2Nlc3MiLCJzbXNDYXB0Y2hhIiwiYWRkQ2xhc3MiLCJjb3VudCIsInVuYmluZCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwidGVsZXBob25lSW5wdXQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJzaG93SW5mbyIsImNhdGFqYXgiLCJnZXQiLCJ1cmwiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsImZhaWwiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJzaWdudXBHcm91cCIsImZpbmQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcm5hbWVJbnB1dCIsImltZ0NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ1c2VybmFtZSIsImltZ19jYXB0Y2hhIiwicGFzc3dvcmQxIiwicGFzc3dvcmQyIiwic21zX2NhcHRjaGEiLCJwb3N0Iiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJhdXRoQm94IiwidXNlck1vcmVYb3giLCJob3ZlciIsInNpZ25pbkdyb3VwIiwicGFzc3dvcmRJbnB1dCIsInJlbWVtYmVySW5wdXQiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsIm1lc3NhZ2VPYmplY3QiLCJjb25zdHJ1Y3RvciIsIlN0cmluZyIsImtleSIsIm1lc3NhZ2UiLCJ0ZW1wbGF0ZSIsImRlZmF1bHRzIiwiaW1wb3J0cyIsInRpbWVTaW5jZSIsImRhdGVWYWx1ZSIsImRhdGUiLCJEYXRlIiwiZGF0ZXRzIiwiZ2V0VGltZSIsInRpbWVzdGFtcCIsIm1pbnV0ZXMiLCJob3VycyIsImRheXMiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF5IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIl0sIm1hcHBpbmdzIjoiQUFjQSxTQUFTQSxPQUNDQyxLQUNKQyxZQUFjQyxFQUFFLGlCQURaRixLQUVKRyxjQUFnQkQsRUFBRSxtQkFHeEJILEtBQUtLLFVBQVVDLElBQU0sV0FDcEIsSUFBSUMsRUFBS04sS0FDVE0sRUFBS0Msa0JBQ0xELEVBQUtFLGtCQUNMRixFQUFLRyxlQUNMSCxFQUFLSSxvQkFDTEosRUFBS0sscUJBQ0xMLEVBQUtNLG1CQUNMTixFQUFLTyx3QkFDTFAsRUFBS1EscUJBR05mLEtBQUtLLFVBQVVXLFVBQVksV0FDakJmLEtBQ0pDLFlBQVllLFFBR2xCakIsS0FBS0ssVUFBVWEsVUFBWSxXQUNoQmpCLEtBQ0xDLFlBQVlpQixRQUdsQm5CLEtBQUtLLFVBQVVHLGdCQUFrQixXQUNoQyxJQUFJRCxFQUFNTixLQUNObUIsRUFBWWpCLEVBQUUsZUFDZGtCLEVBQWFsQixFQUFFLGVBRW5CaUIsRUFBVUUsTUFBTSxXQUNmZixFQUFLUyxZQUNMVCxFQUFLSCxjQUFjbUIsSUFBSSxDQUFDQyxLQUFLLE1BRzlCSCxFQUFXQyxNQUFNLFdBQ2hCZixFQUFLUyxZQUNMVCxFQUFLSCxjQUFjbUIsSUFBSSxDQUFDQyxLQUFLLGNBSS9C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RUFBS1UsU0FHZSxJQUZuQlYsRUFBS1csV0FFdUIsSUFEMUJYLEVBQUtZIiwiZmlsZSI6ImF1dGgubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gY29uc29sZS5sb2coJ3Nzc3MnKVxyXG4vL1xyXG4vLyAkKGZ1bmN0aW9uKCl7XHJcbi8vIFx0JChcIiNidG5cIikuY2xpY2soZnVuY3Rpb24oKXtcclxuLy8gXHRcdCQoJy5tYXNrLXdyYXBwZXInKS5zaG93KCk7XHJcbi8vIFx0fSk7XHJcbi8vXHJcbi8vIFx0JCgnLmNsb3NlLWJ0bicpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbi8vIFx0XHQkKCcubWFzay13cmFwcGVyJykuaGlkZSgpO1xyXG4vLyBcdH0pO1xyXG4vLyB9KTtcclxuLy9cclxuXHJcblxyXG5mdW5jdGlvbiBBdXRoKCkge1xyXG5cdHZhciBzZWxmPXRoaXM7XHJcblx0c2VsZi5tYXNrd3JhcHBlciA9ICQoJy5tYXNrLXdyYXBwZXInKTtcclxuXHRzZWxmLnNjcm9sbFdyYXBwZXIgPSAkKCcuc2Nyb2xsLXdyYXBwZXInKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgc2VsZj10aGlzO1xyXG5cdHNlbGYubGlzdGVuc2hvd0V2ZW50KCk7XHJcblx0c2VsZi5saXN0ZW5oaWRlRXZlbnQoKTtcclxuXHRzZWxmLmxpc3RlblN3aXRjaCgpO1xyXG5cdHNlbGYubGlzdGVuU2lnbmluRXZlbnQoKTtcclxuXHRzZWxmLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xyXG5cdHNlbGYubGlzdGVuaW1nQ2FwdGNoYSgpO1xyXG5cdHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XHJcblx0c2VsZi5saXN0ZW5TaWdudXBFdmVudCgpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24oKXtcclxuXHR2YXIgc2VsZj10aGlzO1xyXG5cdHNlbGYubWFza3dyYXBwZXIuc2hvdygpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuaGlkZUV2ZW50ID0gZnVuY3Rpb24oKXtcclxuXHR2YXIgc2VsZiA9dGhpcztcclxuXHRzZWxmLm1hc2t3cmFwcGVyLmhpZGUoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbnNob3dFdmVudCA9IGZ1bmN0aW9uKCl7XHJcblx0dmFyIHNlbGYgPXRoaXM7XHJcblx0dmFyIHNpZ25pbkJ0biA9ICQoJyNzaWduaW4tYnRuJyk7XHJcblx0dmFyIHNpZ2VudXBCdG4gPSAkKCcjc2lnbnVwLWJ0bicpO1xyXG5cclxuXHRzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0c2VsZi5zaG93RXZlbnQoKTtcclxuXHRcdHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe2xlZnQ6MH0pO1xyXG4gICAgfSk7XHJcblxyXG5cdHNpZ2VudXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0c2VsZi5zaG93RXZlbnQoKTtcclxuXHRcdHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe2xlZnQ6XCItNDAwcHhcIn0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5oaWRlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG5cdHZhciBzZWxmID0gdGhpcztcclxuXHR2YXIgY2xvc2VCdG4gPSAkKCcuY2xvc2UtYnRuJyk7XHJcblx0Y2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0c2VsZi5oaWRlRXZlbnQoKVxyXG4gICAgfSlcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblN3aXRjaCA9IGZ1bmN0aW9uKCl7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdHZhciBzd2l0Y2hlciA9ICQoXCIuc3dpdGNoXCIpO1xyXG5cdHN3aXRjaGVyLmNsaWNrKGZ1bmN0aW9uKCl7XHJcblx0XHR2YXIgY3VycmVudExlZnQgPXNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoXCJsZWZ0XCIpO1xyXG5cdFx0Y3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7XHJcblx0XHRpZiAoY3VycmVudExlZnQgPCAwKSB7XHJcblx0XHRcdHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjpcIjBcIn0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0c2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOlwiLTQwMHB4XCJ9KTtcclxuXHRcdH07XHJcblx0fSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5pbWdDYXB0Y2hhID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBpbWdDYXB0Y2hlID0gJCgnLmltZy1jYXB0Y2hhLWJ0bicpO1xyXG4gICAgaW1nQ2FwdGNoZS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW1nQ2FwdGNoZS5hdHRyKFwic3JjXCIsJy9hY2NvdW50L2ltZ19jYXB0Y2hhLycrXCI/cmFuZG9tXCIrTWF0aC5yYW5kb20oKSlcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2Vzc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2Vzcygn55+t5L+h6aqM6K+B56CB5Y+R6YCB5oiQ5Yqf77yBJyk7XHJcbiAgICBzZWxmLnNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICB2YXIgY291bnQgPSAxMDtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS51bmJpbmQoJ2NsaWNrJyk7XHJcbiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoY291bnQrJ3MnKTtcclxuICAgICAgICBjb3VudCAtPSAxO1xyXG4gICAgICAgIGlmKGNvdW50IDw9IDApe1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGEudGV4dCgn5Y+R6YCB6aqM6K+B56CBJyk7XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwxMDAwKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzbXNDYXB0Y2hhID0gJChcIi5zbXMtY2FwdGNoYS1idG5cIik7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHNtc0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICBpZighdGVsZXBob25lKXtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbygn6K+36L6T5YWl5omL5py65Y+356CB77yBJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGFqYXguZ2V0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6e1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzaWdudXBHcm91cCA9ICQoJy5zaWdudXAtZ3JvdXAnKTtcclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWdudXBHcm91cC5maW5kKCcuc3VibWl0LWJ0bicpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIik7XHJcbiAgICAgICAgdmFyIGltZ0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQySW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIik7XHJcbiAgICAgICAgdmFyIHNtc0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpO1xyXG5cclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gdXNlcm5hbWVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgc21zX2NhcHRjaGEgPSBzbXNDYXB0Y2hhSW5wdXQudmFsKCk7XHJcblxyXG4gICAgICAgIGNhdGFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvcmVnaXN0ZXIvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3VzZXJuYW1lJzogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZDEnOiBwYXNzd29yZDEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQyJzogcGFzc3dvcmQyLFxyXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy/nm5HlkKznlKjmiLfnqpflj6Plh7rnjrDmtojlpLFcclxuQXV0aC5wcm90b3R5cGUubGlzdGVuQXV0aEJveEhvdmVyID0gZnVuY3Rpb24oKXtcclxuXHR2YXIgYXV0aEJveCA9JCgnLmF1dGh3cmFwcGVyJyk7XHJcblx0dmFyIHVzZXJNb3JlWG94ID0kKCcudXNlci1tb3JlLWJveCcpO1xyXG5cdGF1dGhCb3guaG92ZXIoZnVuY3Rpb24gKCkge1xyXG5cdFx0dXNlck1vcmVYb3guc2hvdygpO1xyXG4gICAgfSxmdW5jdGlvbiAoKSB7XHJcblx0XHR1c2VyTW9yZVhveC5oaWRlKCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJCgnLnNpZ25pbi1ncm91cCcpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcblxyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKTtcclxuXHJcbiAgICAgICAgY2F0YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iamVjdCA9IHJlc3VsdFsnbWVzc2FnZSddO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBtZXNzYWdlT2JqZWN0ID09ICdzdHJpbmcnIHx8IG1lc3NhZ2VPYmplY3QuY29uc3RydWN0b3IgPT0gU3RyaW5nKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8ge1wicGFzc3dvcmRcIjpbJ+WvhueggeacgOWkp+mVv+W6puS4jeiDvei2hei/hzIw5Li677yBJywneHh4J10sXCJ0ZWxlcGhvbmVcIjpbJ3h4JywneCddfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGtleSBpbiBtZXNzYWdlT2JqZWN0KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmplY3Rba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgYXV0aCA9bmV3IEF1dGgoKTtcclxuXHRhdXRoLnJ1bigpO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgaWYod2luZG93LnRlbXBsYXRlKXtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xyXG4gICAgICAgICAgICB2YXIgZGF0ZXRzID0gZGF0ZS5nZXRUaW1lKCk7IC8vIOW+l+WIsOeahOaYr+avq+enkueahFxyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOyAvL+W+l+WIsOeahOaYr+W9k+WJjeaXtumXtOeahOaXtumXtOaIs1xyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKS8xMDAwOyAvLyDpmaTku6UxMDAw77yM5b6X5Yiw55qE5piv56eSXHJcbiAgICAgICAgICAgIGlmKHRpbWVzdGFtcCA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+WImuWImic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAgJiYgdGltZXN0YW1wIDwgNjAqNjApIHtcclxuICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcysn5YiG6ZKf5YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCkge1xyXG4gICAgICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBob3Vycysn5bCP5pe25YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCozMCkge1xyXG4gICAgICAgICAgICAgICAgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyKycvJyttb250aCsnLycrZGF5K1wiIFwiK2hvdXIrXCI6XCIrbWludXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuXHJcblxyXG4iXX0=
